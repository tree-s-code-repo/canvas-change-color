<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body onload="start();">
    <canvas id="myCanvas" width="500px" height="500px">Canvas!</canvas>
  </body>
</html>

<script>
  function start() {
    const canvas = document.getElementById("myCanvas");
    const ctx = canvas.getContext("2d");

    // 이미지 객체를 생성합니다.
    const img = new Image();

    // 이미지가 로드되면 캔버스에 그립니다.
    img.onload = function () {
      // 캔버스에 이미지를 그립니다.
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      startColorChange();
    };
    // 이미지 소스를 설정합니다. (로컬 파일 혹은 URL)
    img.src = "./club.png";

    function startColorChange() {
      let lastImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);

      function changeColor() {
        let imageData = lastImageData;
        let data = imageData.data;

        for (let i = 0; i < data.length; i += 4) {
          if (data[i] === 255 && data[i + 1] === 255 && data[i + 2] === 255) {
            data[i] = 128; // R
            data[i + 1] = 128; // G
            data[i + 2] = 128; // B
          } else if (
            data[i] == 128 &&
            data[i + 1] == 128 &&
            data[i + 2] == 128
          ) {
            data[i] = 255; // R
            data[i + 1] = 255; // G
            data[i + 2] = 255; // B
          }
        }

        ctx.putImageData(imageData, 0, 0);
        lastImageData = imageData;

        requestAnimationFrame(changeColor);
      }

      requestAnimationFrame(changeColor);
    }
  }
</script>
